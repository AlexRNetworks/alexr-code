/* Import Google Fonts: 'Inter' for UI, 'Fira Code' for editor (CodeMirror will use its own font settings from its theme by default) */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fira+Code:wght@400;500&display=swap');

/* --- CSS Variables for Theming (Enhanced Default) --- */
:root {
    --font-primary: 'Inter', sans-serif;
    --font-code: 'Fira Code', monospace; /* Used for some elements like settings textarea, CM has its own */

    --color-background-main: #f4f7f9;
    --color-background-header: #ffffff;
    --color-background-editor: #ffffff; /* Background for editor panels AND modal content */
    --color-background-preview: #ffffff;
    --color-background-footer: #2c3e50;
    --color-background-button: #007aff;
    --color-background-button-hover: #005bb5;
    --color-background-section-header: #eef1f4; /* For h2 in editor panels */
    --color-background-input: var(--color-background-main); /* For text inputs/textareas in modals */
    --color-background-gutter: var(--color-background-section-header); /* For Split.js gutters */
    --color-background-gutter-hover: var(--border-color-dark);


    --color-text-main: #333333;
    --color-text-header: #2c3e50;
    --color-text-editor-label: #555555; /* For h2 in editor panels & modal labels */
    --color-text-button: #ffffff;
    --color-text-footer: #e0e0e0;
    --color-text-link: #007aff;
    --color-text-placeholder: #999999;

    --border-color-light: #dce1e6;
    --border-color-dark: #c0c5cb; /* For inputs, etc. */
    --border-radius-main: 8px;
    --border-radius-small: 5px;
    --box-shadow-main: 0 4px 12px rgba(0,0,0,0.06);
    --box-shadow-light: 0 2px 6px rgba(0,0,0,0.04);

    /* For focus rings - ensure your theme files also define this if they change link color */
    --color-text-link-rgb: 0, 123, 255; /* RGB components of --color-text-link */
}
/* --- End CSS Variables --- */

/* General Reset and Body */
*, *::before, *::after {
    box-sizing: border-box;
}

body {
    font-family: var(--font-primary);
    margin: 0;
    background-color: var(--color-background-main);
    color: var(--color-text-main);
    display: flex;
    flex-direction: column;
    min-height: 100vh; /* Full viewport height */
    height: 100vh; /* Ensure body takes full height for flex children */
    overflow: hidden; /* Prevent body scrollbars when panes handle their own */
    line-height: 1.65;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* Header */
header {
    background-color: var(--color-background-header);
    color: var(--color-text-header);
    padding: 0.6rem 1.5rem; /* Slightly reduced padding */
    text-align: center;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid var(--border-color-light);
    box-shadow: var(--box-shadow-light);
    flex-shrink: 0; /* Prevent header from shrinking */
    position: relative; /* For z-index if needed above gutters */
    z-index: 20; /* Ensure header is above gutters */
}

header .header-left, header .header-right {
    flex: 1;
    display: flex;
    align-items: center; /* Vertically align items in header parts */
}
header .header-left {
    justify-content: flex-start;
}
header .header-right {
    justify-content: flex-end;
}
header .header-center {
    flex: 2; /* Allow more space for central controls if needed */
    display: flex;
    justify-content: center;
    gap: 10px;
}

header h1 {
    margin: 0;
    font-size: 1.4rem; /* Slightly smaller */
    font-weight: 600;
}

/* Layout Toggle Buttons in Header */
.layout-toggle-button {
    background-color: var(--color-background-section-header);
    color: var(--color-text-editor-label);
    border: 1px solid var(--border-color-dark);
    padding: 0.4rem 0.8rem;
    border-radius: var(--border-radius-small);
    cursor: pointer;
    font-size: 0.75rem; /* Smaller font */
    font-weight: 500;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
}
.layout-toggle-button:hover {
    background-color: var(--border-color-dark);
    color: var(--color-text-main);
}
.layout-toggle-button.active { /* Style for the active layout button */
    background-color: var(--color-background-button);
    color: var(--color-text-button);
    border-color: var(--color-background-button);
}


.theme-selector-button {
    background-color: transparent;
    color: var(--color-text-link);
    border: 1px solid var(--border-color-light);
    padding: 0.4rem 0.8rem; /* Smaller theme button */
    border-radius: var(--border-radius-small);
    cursor: pointer;
    text-decoration: none;
    font-size: 0.8rem;
    font-weight: 500;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
}

.theme-selector-button:hover,
.theme-selector-button:focus {
    background-color: var(--color-background-button);
    color: var(--color-text-button);
    border-color: var(--color-background-button);
    outline: none;
}

/* Main Layout Container for Split.js */
.editor-layout-container {
    display: flex; 
    flex-grow: 1; /* Takes up all space between header and footer */
    overflow: hidden; /* Crucial */
    padding: 10px; 
    gap: 8px; /* Space for the main gutter, matches Split.js gutterSize */
}
/* Dynamic layout classes - these will be toggled by JavaScript */
.layout-horizontal-main {
    flex-direction: row !important; /* Editors Left | Output Right */
}
.layout-vertical-main {
    flex-direction: column !important; /* Editors Top | Output Bottom */
}


/* Direct children of .editor-layout-container are the main panes for Split.js */
#code-editors-pane, #output-pane {
    display: flex; /* Essential for internal flex behavior */
    flex-direction: column; /* Content within these panes stacks vertically by default */
    overflow: hidden; /* Prevent these panes from showing scrollbars themselves */
    /* Split.js will control flex-basis/width/height */
}

/* Code Editors Area (#code-editors-pane is already a flex column) */
#code-section-editors { /* This div contains the 3 editor panes */
    display: flex;
    flex-direction: row; /* HTML, CSS, JS side-by-side, Split.js manages this too */
    flex-grow: 1; /* Fill #code-editors-pane */
    min-height: 0; /* Important for nested flex elements */
    overflow: hidden; /* Prevent scrollbars on the group */
    /* gap: 8px; /* Gutters will provide spacing */
}

/* Individual Editor Panes (HTML, CSS, JS Wrappers) */
.editor-pane { /* e.g., #html-editor-wrapper */
    display: flex; /* This pane itself is a flex container */
    flex-direction: column; /* Its children (.editor) will stack */
    overflow: hidden; /* This is important! */
    /* flex-basis will be set by Split.js for horizontal splitting */
    /* height will be 100% of parent for vertical splitting */
}

.editor { /* Styles for the .editor div inside .editor-pane */
    display: flex;
    flex-direction: column;
    background-color: var(--color-background-editor);
    border: 1px solid var(--border-color-light);
    border-radius: var(--border-radius-main);
    box-shadow: var(--box-shadow-main);
    overflow: hidden; /* Crucial for CodeMirror */
    height: 100%; /* Make .editor fill its .editor-pane wrapper */
}

.editor h2 {
    background-color: var(--color-background-section-header);
    color: var(--color-text-editor-label);
    margin: 0;
    padding: 8px 12px; /* Reduced padding */
    font-size: 0.85rem; /* Reduced font size */
    font-weight: 600;
    border-bottom: 1px solid var(--border-color-light);
    text-align: left;
    flex-shrink: 0; /* Prevent h2 from shrinking if content is too large */
}

.CodeMirror {
    font-family: var(--font-code);
    font-size: 14px;
    line-height: 1.5;
    height: 100%; /* Make CodeMirror fill the .editor div's available space */
    flex-grow: 1; /* Allows CodeMirror to take remaining space */
    /* border: 1px solid var(--border-color-dark); /* Optional: if you want a border directly on CM instances */
}


/* Output Pane (#output-pane is already a flex column) */
.editor-main-controls {
    margin-bottom: 8px; /* Space below controls */
    text-align: center;
    padding: 5px 0; /* Reduced padding */
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 8px;
    flex-shrink: 0; /* Prevent controls from shrinking */
}
.editor-main-controls button {
    background-color: var(--color-background-button);
    color: var(--color-text-button);
    border: none;
    padding: 6px 12px; /* Smaller buttons */
    border-radius: var(--border-radius-small);
    cursor: pointer;
    font-size: 0.8rem; /* Smaller font */
    font-weight: 500;
    transition: background-color 0.2s ease, transform 0.1s ease;
}
.editor-main-controls button:hover { background-color: var(--color-background-button-hover); transform: translateY(-1px); }
.editor-main-controls button:active { transform: translateY(0px); }

/* Output Sub-Panes Wrappers (Preview, Console Wrappers) */
.output-sub-pane { /* e.g., #preview-wrapper, #console-wrapper */
    display: flex; /* These wrappers should be flex to allow their children to grow */
    flex-direction: column; /* Their children (.preview-section, .console-section) stack */
    overflow: hidden; /* Important for nested splits */
    /* flex-basis will be set by Split.js for vertical splitting */
    /* height will be 100% of parent for horizontal splitting (if output pane is a row item) */
}

.preview-section, .console-section {
    flex-grow: 1; /* Make these fill their respective wrappers */
    display: flex;
    flex-direction: column;
    background-color: var(--color-background-editor); /* Base background */
    border: 1px solid var(--border-color-light);
    border-radius: var(--border-radius-main);
    box-shadow: var(--box-shadow-main);
    overflow: hidden; /* Content will scroll internally */
    height: 100%; /* Ensure they take full height of their split pane parent */
}
.preview-section { background-color: var(--color-background-preview); } /* Specific preview BG */

.preview-section h2, .console-header { /* Common styling for headers of these sections */
    background-color: var(--color-background-section-header);
    color: var(--color-text-editor-label);
    margin: 0;
    padding: 8px 12px; /* Reduced padding */
    font-size: 0.85rem; /* Reduced font size */
    font-weight: 600;
    border-bottom: 1px solid var(--border-color-light);
    text-align: left;
    flex-shrink: 0; /* Prevent header from shrinking */
}
.console-header { display: flex; justify-content: space-between; align-items: center; }

#preview-frame { flex-grow: 1; width: 100%; border: none; background-color: var(--color-background-preview); }

#clear-console-button {
    background-color: transparent; color: var(--color-text-link); border: 1px solid var(--border-color-dark);
    padding: 3px 8px; font-size: 0.75rem; border-radius: var(--border-radius-small); cursor: pointer;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
}
#clear-console-button:hover { background-color: var(--color-background-button); color: var(--color-text-button); border-color: var(--color-background-button); }

#console-output {
    flex-grow: 1; padding: 8px 12px; overflow-y: auto; font-family: var(--font-code);
    font-size: 0.85em; line-height: 1.6; white-space: pre-wrap; word-break: break-all;
    background-color: var(--color-background-editor); /* Match editor background */
    color: var(--color-text-main); /* Ensure text color matches */
}
.console-message { padding: 2px 0; border-bottom: 1px solid var(--border-color-light); margin-bottom: 2px; }
.console-message:last-child { border-bottom: none; margin-bottom: 0; }
.console-message.log { color: var(--color-text-main); }
.console-message.error { color: #e74c3c; font-weight: bold; }
.console-message.warn { color: #f39c12; }
.console-message.info { color: #3498db; }
.console-message.debug { color: #9b59b6; }
.console-message .timestamp { color: var(--color-text-editor-label); font-size: 0.9em; margin-right: 8px; opacity: 0.7; }

/* Split.js Gutter Styling */
.gutter {
    background-color: var(--color-background-gutter);
    background-repeat: no-repeat;
    background-position: 50%;
    transition: background-color 0.2s ease;
    z-index: 10; /* Ensure gutters are above editor content if overlapping occurs */
}
.gutter:hover {
    background-color: var(--color-background-gutter-hover);
}
.gutter.gutter-horizontal { 
    cursor: col-resize;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeAgB+oz4K9qXoRgAAAABJRU5ErkJggg==');
}
.gutter.gutter-vertical { 
    cursor: row-resize;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFAQMAAABo7865AAAABlBMVEVHcEzMzMzyAv2sAAAAAXRSTlMAQObYZgAAABBJREFUeF5jOAMEEAIEEFwAn3kMwcB6I2AAAAAASUVORK5CYII=');
}


/* Footer */
footer {
    background-color: var(--color-background-footer);
    color: var(--color-text-footer);
    text-align: center;
    padding: 0.8rem 1.5rem; /* Reduced padding */
    margin-top: auto; /* This works when body is display:flex; flex-direction:column; */
    font-size: 0.8rem; /* Reduced font size */
    flex-shrink: 0; /* Prevent footer from shrinking */
    position: relative; /* For z-index if needed */
    z-index: 20; /* Ensure footer is above gutters if overlap occurs */
}

/* --- Modal Styles (Generic for Save, Load, Settings) --- */
.modal {
    display: none; position: fixed; z-index: 1000; left: 0; top: 0;
    width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.5);
    backdrop-filter: blur(4px); animation: fadeIn 0.2s ease-out;
}
@keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

.modal-content {
    background-color: var(--color-background-editor); color: var(--color-text-main);
    margin: 10vh auto; padding: 25px 30px; border: 1px solid var(--border-color-light);
    border-radius: var(--border-radius-main); width: 90%; max-width: 550px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.25); position: relative;
    animation: slideInModal 0.25s ease-out;
}
@keyframes slideInModal { from { transform: translateY(-25px) scale(0.98); opacity: 0; } to { transform: translateY(0) scale(1); opacity: 1; } }

.close-button {
    color: var(--color-text-editor-label); position: absolute; top: 10px; right: 15px;
    font-size: 28px; font-weight: bold; transition: color 0.2s ease;
}
.close-button:hover, .close-button:focus { color: var(--color-text-main); text-decoration: none; cursor: pointer; }

.modal h2 { margin-top: 5px; margin-bottom: 25px; color: var(--color-text-header); font-weight: 600; font-size: 1.3rem; }
.modal label { display: block; margin-bottom: 8px; font-weight: 500; color: var(--color-text-editor-label); }

.modal input[type="text"], .modal textarea {
    width: 100%; padding: 10px 12px; margin-bottom: 20px; border: 1px solid var(--border-color-dark);
    border-radius: var(--border-radius-small); font-family: var(--font-primary); font-size: 1em;
    background-color: var(--color-background-input); color: var(--color-text-main);
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
}
.modal textarea { font-family: var(--font-code); font-size: 0.9em; resize: vertical; min-height: 80px; }

.modal input[type="text"]:focus, .modal textarea:focus {
    outline: none; border-color: var(--color-text-link);
    box-shadow: 0 0 0 3px rgba(var(--color-text-link-rgb), 0.2);
}

.modal-actions { display: flex; justify-content: flex-end; gap: 12px; margin-top: 25px; }
.modal-actions button {
    padding: 10px 20px; border-radius: var(--border-radius-small); font-weight: 500; cursor: pointer;
    transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease, opacity 0.2s ease;
    border: 1px solid transparent; font-size: 0.9rem;
}
.modal-actions button:hover { opacity: 0.85; } /* General hover for modal buttons */

.modal-actions button.primary-action {
    background-color: var(--color-background-button); color: var(--color-text-button); border-color: var(--color-background-button);
}
.modal-actions button.primary-action:hover {
    background-color: var(--color-background-button-hover); border-color: var(--color-background-button-hover); opacity: 1;
}

.modal-actions button.button-alt {
    background-color: transparent; color: var(--color-text-editor-label); border-color: var(--border-color-dark);
}
.modal-actions button.button-alt:hover {
    background-color: var(--color-background-section-header); color: var(--color-text-main); border-color: var(--border-color-dark); opacity: 1;
}

/* Project List Styling (Load Modal) */
#projects-list-container {
    max-height: 35vh; overflow-y: auto; margin-bottom: 20px; border: 1px solid var(--border-color-light);
    border-radius: var(--border-radius-small); padding: 5px; background-color: var(--color-background-input);
}
.project-item {
    display: flex; justify-content: space-between; align-items: center; padding: 10px;
    border-bottom: 1px solid var(--border-color-light); transition: background-color 0.15s ease;
}
.project-item:last-child { border-bottom: none; }
.project-item:hover { background-color: var(--color-background-section-header); }

.project-item-name {
    font-weight: 500; color: var(--color-text-main); flex-grow: 1; margin-right: 10px;
    overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}
.project-item-actions button { margin-left: 8px; padding: 5px 10px; font-size: 0.8rem; }
.project-item-actions button.load-button { /* Load button in list */
    background-color: var(--color-background-button); color: var(--color-text-button); border-color: var(--color-background-button);
}
.project-item-actions button.load-button:hover {
    background-color: var(--color-background-button-hover); border-color: var(--color-background-button-hover); opacity: 1;
}
.project-item-actions button.delete-button {
    background-color: transparent; color: #e74c3c; border-color: #e74c3c;
}
.project-item-actions button.delete-button:hover { background-color: #e74c3c; color: white; opacity: 1; }

/* Settings Modal Specifics */
.setting-section { margin-bottom: 20px; }
.setting-section:last-of-type { margin-bottom: 0; }
